<!DOCTYPE html>
<html>
<head>
    <title>Test Registration</title>
</head>
<body>
    <h1>Test Registration</h1>
    <form id="registerForm">
        <input type="email" id="email" placeholder="Email" required><br>
        <input type="text" id="username" placeholder="Username" required><br>
        <input type="text" id="fullName" placeholder="Full Name (optional)"><br>
        <input type="password" id="password" placeholder="Password" required><br>
        <button type="submit">Register</button>
    </form>
    <div id="result"></div>

    <script>
        const form = document.getElementById('registerForm');
        const result = document.getElementById('result');

        // Add a random number to make email/username unique
        const random = Math.floor(Math.random() * 100000);
        document.getElementById('email').value = `test${random}@example.com`;
        document.getElementById('username').value = `testuser${random}`;
        document.getElementById('password').value = 'TestPassword123!';
        document.getElementById('fullName').value = 'Test User';

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            const data = {
                email: document.getElementById('email').value,
                username: document.getElementById('username').value,
                password: document.getElementById('password').value,
                fullName: document.getElementById('fullName').value || undefined
            };

            console.log('Sending registration request:', data);
            result.innerHTML = 'Sending request...';

            try {
                const response = await fetch('https://sdf1ljix88.execute-api.us-east-1.amazonaws.com/auth/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                const responseData = await response.json();
                console.log('Response status:', response.status);
                console.log('Response data:', responseData);

                if (response.ok) {
                    result.innerHTML = `<pre style="color: green;">SUCCESS!\n${JSON.stringify(responseData, null, 2)}</pre>`;
                } else {
                    result.innerHTML = `<pre style="color: red;">ERROR ${response.status}:\n${JSON.stringify(responseData, null, 2)}</pre>`;
                }
            } catch (error) {
                console.error('Request failed:', error);
                result.innerHTML = `<pre style="color: red;">NETWORK ERROR:\n${error.message}</pre>`;
            }
        });
    </script>
</body>
</html>